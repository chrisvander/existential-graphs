(this["webpackJsonpexistential-graphs"]=this["webpackJsonpexistential-graphs"]||[]).push([[0],{14:function(e){e.exports=JSON.parse('{"binary":{"<->":"\\\\leftrightarrow","%":"\\\\leftrightarrow","->":"\\\\rightarrow","$":"\\\\rightarrow","&":"\\\\land","|":"\\\\lor"},"unary":{"~":"\\\\lnot","!":"\\\\lnot"},"eg":{"<->":"($1($2))(($1)$2)","%":"($1($2))(($1)$2)","->":"(($1)$2)","$":"(($1)$2)","&":"$1$2","|":"(($1)($2))"}}')},24:function(e,t,n){e.exports=n(59)},29:function(e,t,n){},30:function(e,t,n){},34:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},59:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(11),s=n.n(i),o=(n(29),n(3)),c=n(4),l=n(1),u=n(6),h=n(5),d=(n(30),n(13)),p=n(14),f=p.binary,v=p.unary;function m(e){return"(?:"+(e=e.map((function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}))).join("|")+")"}var g=m(Object.keys(v)),b="^(".concat(g,"*[A-Za-z]+|").concat(g,"*\\((.*)\\))(").concat(m(Object.keys(f)),")(").concat(g,"*[A-Za-z]+|").concat(g,"*\\((.*)\\))$"),y=new RegExp(b),E=new RegExp("^".concat(g,"*[A-Za-z]+$")),S=new RegExp("^".concat(g,"*\\((.*)\\)$"));var C=function(e){return function e(t){var n;return!!t.match(E)||(null!==(n=y.exec(t))?null!=n&&(n[2]&&n[5]?e(n[2])&&e(n[5]):n[2]?e(n[2]):!n[5]||e(n[5])):null!==(n=S.exec(t))?e(n[1]):void 0)}(e=e.replace(/\s/g,""))},k=n(14);function O(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var w=k.binary,j=Object.keys(w);j=j.map((function(e){return O(e)}));var x=new RegExp("(?:"+j.join("|")+")","g"),N=k.unary;function D(e){var t=function(e){return function(t){return t===e}},n=0;for(n in e.split(""))if(!Object.keys(N).some(t(e.charAt(n))))break;return n}var R=function(e,t){null==t&&(t=!0);var n=D(e),a=e.substr(n);return a=t?P(a):"{"+a+"}","(".repeat(n)+a+")".repeat(n)},P=function e(t){if(("string"===typeof t||t instanceof String)&&C(t)){t=t.replace(/\s/g,"");var n=y.exec(t),a=S.exec(t),r=E.exec(t);if(n){var i=e(n[1]),s=e(n[4]);return k.eg[n[3]].replace(/\$1/g,i).replace(/\$2/g,s)}return a?0!=D(t)?R(t):e(a[1]):r?R(t,!1):null}return null},I=function(e,t){for(var n=0,a=t;a<e.length;){if("("===e[a])n++;else if(")"===e[a]&&0===--n)return a;a++}},z=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={functions:[{str:"Iterate",func:"iterate",highlight:{cut:"all",var:"all"}},{str:"Remove Double Cut",func:"dcRemove",highlight:{cut:"all"}},{str:"Add Double Cut",func:"dcAdd",highlight:{cut:"all",var:"all"}},{str:"Erasure",func:"erase",highlight:{cut:"even",var:"even"}}]},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return this.props.hidden?r.a.createElement(r.a.Fragment,null):r.a.createElement("div",{className:"toolbox",ref:this.canvas},r.a.createElement("h3",null,"Tools"),this.state.functions.map((function(t){return r.a.createElement("div",{className:"tool",onClick:function(){return e.props.setSelection(t.highlight,t.func)}},t.str)})))}}]),n}(r.a.Component),A=n(7),$=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).performRedo=a.performRedo.bind(Object(l.a)(a)),a.performUndo=a.performUndo.bind(Object(l.a)(a)),a.state={},a}return Object(c.a)(n,[{key:"handleClick",value:function(e,t,n){e.preventDefault(),n||this.props.setStep(t)}},{key:"performUndo",value:function(e){var t=this.props.state,n=t.changeHistory,a=t.steps,r=t.redoHistory,i=n.pop();i&&(r.push(a),this.props.setState(n,i.steps,r))}},{key:"performRedo",value:function(e){var t=this.props.state,n=t.changeHistory,a=t.steps,r=t.redoHistory,i=r.pop();i&&(n.push({redoHistory:r,steps:a}),this.props.setState(n,i,r))}},{key:"getColor",value:function(e){return e?"rgb(136, 136, 136)":"rgb(68, 68, 68)"}},{key:"disable",value:function(e,t){return e.concat(t.length>0?"":" disabled")}},{key:"render",value:function(){var e=this,t=this.props,n=t.hide,a=t.currentStep,i=t.stepInfo,s=t.state,o=s.changeHistory,c=s.redoHistory;if(n)return r.a.createElement(r.a.Fragment,null);var l=a===i.length-1,u=0===a;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"step-menu"},r.a.createElement("div",{style:{color:this.getColor(u)}},r.a.createElement("div",{onClick:function(t){return e.handleClick(t,0,u)}},r.a.createElement(A.a,{src:"/existential-graphs/assets/step-first.svg"})),r.a.createElement("div",{onClick:function(t){return e.handleClick(t,a-1,u)}},r.a.createElement(A.a,{src:"/existential-graphs/assets/step-prev.svg"}))),r.a.createElement("div",null,r.a.createElement("div",{className:this.disable("undo-btn",o),onClick:this.performUndo},r.a.createElement("div",{className:"undo-svg"},r.a.createElement(A.a,{src:"/existential-graphs/assets/undo.svg"}))),r.a.createElement("div",{className:this.disable("redo-btn",c),onClick:this.performRedo},r.a.createElement("div",{className:"redo-svg"},r.a.createElement(A.a,{src:"/existential-graphs/assets/redo.svg"})))),r.a.createElement("div",{style:{color:this.getColor(l)}},r.a.createElement("div",{onClick:function(t){return e.handleClick(t,a+1,l)}},r.a.createElement(A.a,{src:"/existential-graphs/assets/step-next.svg"})),r.a.createElement("div",{onClick:function(t){return e.handleClick(t,i.length-1,l)}},r.a.createElement(A.a,{src:"/existential-graphs/assets/step-last.svg"})))),r.a.createElement("div",{className:"step-text"},"Step ",a+1," of ",i.length))}}]),n}(r.a.Component),F={gridSize:1,cutPadding:{horizontal:10,vertical:5},cutCornerRadius:10,initialSeparation:50},L=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).text=r.a.createRef(),a.getCoords=a.props.getCoords,a.handleClick=a.handleClick.bind(Object(l.a)(a)),a.state={x:e.x,y:e.y,cursorOver:!1,dragging:!1},a.panzoom=a.props.panzoom,window.addEventListener("mousemove",a.onMouseMove.bind(Object(l.a)(a))),window.addEventListener("mousedown",a.handleDragStart.bind(Object(l.a)(a))),window.addEventListener("mouseup",a.handleDragEnd.bind(Object(l.a)(a))),window.addEventListener("click",a.handleClick),a}return Object(c.a)(n,[{key:"handleClick",value:function(){this.state.cursorOver&&this.props.enableHighlight&&this.props.selectedCallback&&(this.props.selectedCallback(this.props.id),this.setState({cursorOver:!1}))}},{key:"componentDidMount",value:function(){this.text.current.style.cursor="pointer"}},{key:"handleDragStart",value:function(e){this.state.cursorOver&&(this.panzoom.pause(),this.setState({dragging:!0}))}},{key:"handleDragEnd",value:function(e){this.panzoom.resume();var t=this.state,n=t.x,a=t.y;this.props.setCoords(n,a),this.setState({dragging:!1})}},{key:"onMouseMove",value:function(e){if(this.state.dragging){var t=this.getCoords(e.clientX,e.clientY),n=t.x,a=t.y;n=Math.round(n/F.gridSize)*F.gridSize,a=Math.round(a/F.gridSize)*F.gridSize,this.props.setCoords(n,a),this.setState({x:n,y:a})}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick),window.removeEventListener("mousemove",this.onMouseMove.bind(this)),window.removeEventListener("mousedown",this.handleDragStart.bind(this)),window.removeEventListener("mouseup",this.handleDragEnd.bind(this))}},{key:"render",value:function(){var e=this,t=this.state.cursorOver&&this.props.enableHighlight;return r.a.createElement("text",{className:"noselect",pointerEvents:this.props.interaction?null:"none",x:this.state.x,y:this.state.y,id:this.props.id,fill:t?"blue":"black",onMouseEnter:function(){return e.setState({cursorOver:!0})},onMouseLeave:function(){return e.setState({cursorOver:!1})},ref:this.text},this.props.children)}}]),n}(r.a.Component),H=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).cut=r.a.createRef(),a.BB=r.a.createRef(),a.getBBoxData=a.getBBoxData.bind(Object(l.a)(a)),a.handleClick=a.handleClick.bind(Object(l.a)(a)),a.update=a.update.bind(Object(l.a)(a)),a.state={highlight:!1,bounding:{_x:0,_y:0,_w:0,_h:0}},window.addEventListener("click",a.handleClick),a}return Object(c.a)(n,[{key:"handleClick",value:function(){this.state.highlight&&this.props.enableHighlight&&this.props.selectedCallback&&(this.props.selectedCallback(this.props.id),this.setState({highlight:!1}))}},{key:"getBBoxData",value:function(){if(this.cut.current){var e=this.cut.current.getBBox(),t=e.x,n=e.y,a=e.width,r=e.height;return{_x:t-F.cutPadding.horizontal,_y:n-F.cutPadding.vertical,_w:a+2*F.cutPadding.horizontal,_h:r+2*F.cutPadding.vertical}}return{}}},{key:"update",value:function(){var e=this;this.interval||(this.interval=setInterval((function(){e.setState({bounding:e.getBBoxData()})}),1),setTimeout((function(){clearInterval(e.interval),e.interval=null}),100))}},{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick),this.interval&&clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=this.props.children;t.length<1&&(t=r.a.createElement(n,null," "));var a=this.state.highlight&&this.props.enableHighlight,i=this.state.bounding,s=i._x,o=i._y,c=i._w,l=i._h;return r.a.createElement(r.a.Fragment,null,r.a.createElement("rect",{x:s,y:o,width:c,height:l,fillOpacity:"0.7",strokeOpacity:"1",stroke:"black",fill:a?"#9AA899":"white",onMouseEnter:function(){return e.setState({highlight:!0})},onMouseLeave:function(){return e.setState({highlight:!1})},rx:F.cutCornerRadius.toString(),ry:F.cutCornerRadius.toString()}),r.a.createElement("g",{ref:this.cut},this.props.children))}}]),n}(r.a.Component),M=(n(34),n(22)),T=n.n(M),B=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.menuItems;return r.a.createElement("div",{className:"dropdown-menu"},e.map((function(e){return e.title?r.a.createElement("div",{className:"menu-title",onClick:e.func},e.title):r.a.createElement("div",{className:e})})))}}]),n}(r.a.Component),U=n(8),W=n.n(U),G=n(23),V=n(15).nanoid;var _=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).canvas=r.a.createRef(),a.canvasContainer=r.a.createRef(),a.renderStep=a.renderStep.bind(Object(l.a)(a)),a.changePos=a.changePos.bind(Object(l.a)(a)),a.getSVGCoords=a.getSVGCoords.bind(Object(l.a)(a)),a.highlightCut=a.highlightCut.bind(Object(l.a)(a)),a.startSelection=a.startSelection.bind(Object(l.a)(a));var i=a.props.proof,s=i.premises,c=i.conclusion,u=i.steps,h=i.data;return console.log(u.length-1),a.state={proof:{premises:s,conclusion:c},changeHistory:[],redoHistory:[],steps:u||[],data:h||{},currentStep:0!==u.length?u.length-1:0,moveListeners:[],highlights:{cut:"none",var:"none"},cbFunction:null,interaction:!0,functions:{insert:function(e){console.log("INSERTION")},erase:function(e){return console.log("ERASURE"),W()(a.state).erasure(e)},iterate:function(e){return console.log("ITERATION"),W()(a.state).iteration(e,a.state.steps[a.state.currentStep].data[0].id)},dcRemove:function(e){return console.log("DOUBLE CUT Remove"),W()(a.state).doubleCutRemove(e)},dcAdd:function(e){return console.log("DOUBLE CUT Add"),W()(a.state).doubleCutAdd(e)}}},a}return Object(c.a)(n,[{key:"startSelection",value:function(e,t){var n=this,a=this.state,r=a.steps,i=a.currentStep,s=a.changeHistory;(s=s.slice()).push({steps:Array.from(r)}),i+1===r.length&&this.setState({highlights:e,interaction:!1,cbFunction:function(e){var a=n.state.functions[t](e);a&&n.setState(Object(d.a)({changeHistory:s,redoHistory:[]},a)),n.setState({highlights:{cut:"none",var:"none"},interaction:!0,cbFunction:null})}})}},{key:"changePos",value:function(e,t,n){var a=this.state.data;Object.assign(a[e],{x:t,y:n}),this.setState(a)}},{key:"highlightCut",value:function(e){if("all"===this.state.highlights.cut)return!0;var t=!1;return e%2===1&&(t=!0),!("odd"!==this.state.highlights.cut||!t)||"even"===this.state.highlights.cut&&!t}},{key:"highlightVar",value:function(e){if("all"===this.state.highlights.var)return!0;var t=!1;return e%2===1&&(t=!0),!("odd"!==this.state.highlights.var||!t)||"even"===this.state.highlights.var&&!t}},{key:"renderStep",value:function(e){var t=this,n=this.state.data,a=this.state.steps[e];if(a){var i=function e(a){var i=[],s=function(s){if("cut"===a[s].type){var o=n[a[s].id].level,c=r.a.createElement(H,{level:o,enableHighlight:t.highlightCut(o),id:a[s].id,selectedCallback:t.state.cbFunction},e(a[s].data));i.push(c)}else{var l=t.state.data[a[s]],u=n[a[s]].level;i.unshift(r.a.createElement(L,{x:l.x,y:l.y,id:a[s],enableHighlight:t.highlightVar(u),selectedCallback:t.state.cbFunction,panzoom:t.panzoom,interaction:t.state.interaction||t.highlightVar(u),getCoords:t.getSVGCoords,setCoords:function(e,r){return function(e,a,r){n[e].x=a,n[e].y=r,t.setState({data:n})}(a[s],e,r)},key:a[s]},l.var))}};for(var o in a)s(o);return i};return i.bind(this),i(a.data)}}},{key:"componentDidMount",value:function(){this.panzoom=T()(this.canvas.current,{maxZoom:6,minZoom:.5});var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=this.state.steps;if(0===n.length){var a=function(e,t){var n={},a=0,r=0,i=0;return{stepZero:{data:function e(t,s,o){for(var c in console.log(n),t)if(t[c]instanceof Array&&t[c].length>0){var l=V();t[c]={data:e(t[c],s+1),id:l,type:"cut"},n[l]={type:"cut",level:s}}else{var u=a,h=V();n[h]={type:"var",var:t[c],x:Math.round(u/F.gridSize)*F.gridSize,y:Math.round(0/F.gridSize)*F.gridSize,level:s},t[c]=h,i=0>i?0:i,r=u>r?u:r,a+=F.initialSeparation}return t}(e,t),h:i+22,w:r},data:n}}(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("string"===typeof t||t instanceof String){for(var a=[];n<t.length;){if("("===t[n]){var r=I(t,n),i=t.substr(n+1,r-1);i&&a.push(e(t.substr(n+1,r-1))),n=r}else if("{"===t[n]){var s=t[++n];"}"===s?a.push("\xa0"):a.push(s),n++}n++}return a}return null}(this.state.proof.premises.join("")),0),r=a.stepZero,i=a.data;n.push(r),this.setState({steps:n,data:i})}this.setState({});var s=this.state.steps[this.state.currentStep];this.panzoom.moveTo(e/2-s.w,t/2-s.h),this.panzoom.zoomTo(e/2-s.w,t/2-s.h,2)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this)}},{key:"getSVGCoords",value:function(e,t){var n=this.canvasContainer.current.createSVGPoint();return n.x=e,n.y=t,n.matrixTransform(this.canvas.current.getScreenCTM().inverse())}},{key:"render",value:function(){var e=this,t=this.state,n=t.proof,a=t.data,i=t.steps,s=t.currentStep;this.props.saveProof(Object(d.a)({},n,{data:a,steps:i}));var o=function(){};return this.panzoom&&(o=this.panzoom.zoomWithWheel),r.a.createElement(G.CSSTransitionGroup,{transitionName:"example",transitionAppear:!0,transitionAppearTimeout:500,transitionEnter:!1,transitionLeaveTimeout:300},r.a.createElement("div",{key:"main-div",className:"noselect"},r.a.createElement(B,{menuItems:this.props.menuItems}),r.a.createElement(z,{hidden:s+1!==i.length,functions:this.state.functions,setSelection:this.startSelection}),r.a.createElement("svg",{ref:this.canvasContainer,className:"canvas noselect",onWheel:o},r.a.createElement("g",{ref:this.canvas},this.panzoom&&this.renderStep(this.state.currentStep))),r.a.createElement($,{currentStep:this.state.currentStep,stepInfo:this.state.steps,setStep:function(t){return e.setState({currentStep:t,interaction:t===e.state.steps.length-1})},state:this.state,setState:function(t,n,a){e.setState({changeHistory:t,steps:n,redoHistory:a,currentStep:n.length-1})}})))}}]),n}(r.a.Component),Z=(n(55),n(12)),J=n.n(Z),X=(n(57),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={premises:[""],conclusion:""},a.handleChange.bind(Object(l.a)(a)),a.removePremise.bind(Object(l.a)(a)),a.verify=a.verify.bind(Object(l.a)(a)),a.create=a.create.bind(Object(l.a)(a)),a.filename=r.a.createRef(),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"handleChange",value:function(e,t){if(null!=t){var n=this.state.premises;n[t]=e.target.value,this.setState({premises:n})}else this.setState({conclusion:e.target.value})}},{key:"removePremise",value:function(e){var t=this.state.premises;t.splice(e,1),this.setState({premises:t})}},{key:"verify",value:function(){var e=this.state,t=e.premises,n=e.conclusion;for(var a in t)if(""===t[a]||!t[a])return!1;return!(""===n||!n)}},{key:"create",value:function(){if(console.log("Creating..."),console.log("Verification concluded "+this.verify()),this.verify()){var e=this.state,t=e.premises,n=e.conclusion;for(var a in t)t[a]=P(t[a]),console.log(t[a]);n=P(n),this.props.setupFunc(this.filename.current.value,{premises:t,conclusion:n,steps:[]})}}},{key:"getFormulaCell",value:function(e,t){var n,a,i=this;C(e)&&(n=function(e){if("string"===typeof e||e instanceof String){var t;for(e=e.replace(/\s/g,"");null!==(t=x.exec(e));)e=e.substr(0,t.index)+w[t[0]]+" "+e.substr(t.index+t[0].length);for(var n in Object.keys(N))t=Object.keys(N)[n],e=e.replace(new RegExp(O(t),"g"),N[t]+" ");return e=e.replace(/[^()A-Za-z\\\s]/g,"")}return""}(e),a=P(e));var s=r.a.createElement("td",{className:"close interactive",onClick:function(){return i.removePremise(t)}},"\u2715"),o=r.a.createElement("input",{onChange:function(e){return i.handleChange(e,t)}});return null==t&&(o=r.a.createElement("input",{onChange:function(e){return i.handleChange(e)}}),s=r.a.createElement("td",{className:"close"})),0===t&&(s=r.a.createElement("td",{className:"close"})),r.a.createElement("tr",null,r.a.createElement("td",null,o),r.a.createElement("td",null,n&&r.a.createElement(J.a,{math:n})),r.a.createElement("td",null,a&&r.a.createElement(J.a,{math:a})),s)}},{key:"render",value:function(){var e=this,t=this.state,n=t.premises,a=t.conclusion;return r.a.createElement("div",{className:"content full-width"},r.a.createElement("h1",null,"Create New"),r.a.createElement("h2",null,"File Name"),r.a.createElement("input",{ref:this.filename}),r.a.createElement("table",{className:"formulaTable"}),r.a.createElement("h2",null,"Premises"),r.a.createElement("table",{className:"formulaTable"},r.a.createElement("tr",null,r.a.createElement("td",null,"Formula"),r.a.createElement("td",null,"TeX notation"),r.a.createElement("td",null,"EG notation"),r.a.createElement("td",{className:"close"})),n.map((function(t,n){return e.getFormulaCell(t,n)})),r.a.createElement("tr",null,r.a.createElement("td",{className:"interactive",onClick:function(){return e.setState({premises:n.concat([""])})}},r.a.createElement("span",{className:"plus"}),"Add New Premise"),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",{className:"close"}))),r.a.createElement("h2",null,"Conclusion"),r.a.createElement("table",{className:"formulaTable"},this.getFormulaCell(a)))}}]),n}(r.a.Component)),Y=(n(58),function(e){var t=e.recentDocs;return r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"column"},r.a.createElement("h1",null,"Existential Graphs"),r.a.createElement("p",null,"Using this tool, you can initialize proofs in the existential graph schema and then you can go through the process of solving them. You can save these proofs and look back at them later.")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"column"},r.a.createElement("h1",null,"Recent Proofs"),Object.keys(t).map((function(e){return r.a.createElement("div",{className:"proofField",onClick:function(){return t[e].open()}},e)}))))}),q=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).createView=r.a.createRef(),a.callCreate=a.callCreate.bind(Object(l.a)(a)),a.animateAway=a.animateAway.bind(Object(l.a)(a)),a.openFile=a.openFile.bind(Object(l.a)(a)),a.state={createShown:!1,floatingWindowCSS:"floating-window shown"},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"animateAway",value:function(){this.setState({floatingWindowCSS:"floating-window"})}},{key:"callCreate",value:function(){this.createView.current.create()}},{key:"openFile",value:function(){var e=this,t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("accept",".egprf"),t.onchange=function(t){console.log("ONCHANGE"),t.stopPropagation(),t.preventDefault();var n=t.target.files[0];console.log(n);var a=new FileReader;a.addEventListener("load",(function(t){try{var a=JSON.parse(t.target.result);console.log(a),e.props.setupFunc(n.name.split(".egprf")[0],a)}catch(r){console.error(r),alert("Corrupt file or improper formatting.")}})),a.readAsText(n)},t.click()}},{key:"render",value:function(){var e=this,t=this.state,n=t.createShown,a=t.floatingWindowCSS;return r.a.createElement("div",{className:a},!n&&r.a.createElement(Y,{recentDocs:this.props.recentDocs}),n&&r.a.createElement(X,{setupFunc:this.props.setupFunc,ref:this.createView}),!n&&r.a.createElement("div",{className:"toolbar"},r.a.createElement("button",{onClick:function(){return e.setState({createShown:!0})}},"New"),r.a.createElement("button",{onClick:this.openFile},"Open")),n&&r.a.createElement("div",{className:"toolbar"},r.a.createElement("button",{className:"back",onClick:function(){return e.setState({createShown:!1})}},r.a.createElement("span",null,r.a.createElement(A.a,{className:"svg",src:"/existential-graphs/assets/back-caret.svg"})),"Back"),r.a.createElement("button",{onClick:this.callCreate},"Create")))}}]),n}(r.a.Component),K=window.localStorage,Q=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).createNewProof=a.createNewProof.bind(Object(l.a)(a)),a.setupProof=a.setupProof.bind(Object(l.a)(a)),a.openCanvas=a.openCanvas.bind(Object(l.a)(a)),a.saveProof=a.saveProof.bind(Object(l.a)(a)),a.getRecents=a.getRecents.bind(Object(l.a)(a)),a.introWindow=r.a.createRef(),a.state={initialCSS:"initial",canvasOpen:!1,popupOpen:!1,filename:"",proof:{premises:[],conclusion:"",steps:[]},recentDocs:a.getRecents()},console.log(a.state.recentDocs),a.menuItems=[{title:"Exit",func:function(){a.setState({initialCSS:"initial",canvasOpen:!1,popupOpen:!1,filename:"",proof:{premises:[],conclusion:"",steps:[]},recentDocs:a.getRecents()})}},"separator",{title:"Export",func:function(){var e=document.createElement("a"),t=new Blob([JSON.stringify(a.state.proof)],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download=a.state.filename+".egprf",document.body.appendChild(e),e.click()}}],a}return Object(c.a)(n,[{key:"getRecents",value:function(){var e=this,t=K.getItem("recentDocs");t=t?JSON.parse(t):{};var n=Object.keys(t),a=function(a){t[n[a]].open=function(){e.setState({filename:n[a],proof:t[n[a]]}),e.openCanvas()}};for(var r in n)a(r);return t}},{key:"saveProof",value:function(e){var t=this.state.recentDocs;return t[e]=this.state.proof,function(n){t[e]=n,K.setItem("recentDocs",JSON.stringify(t))}}},{key:"setupProof",value:function(e,t){this.setState({filename:e,proof:t}),this.openCanvas()}},{key:"openCanvas",value:function(){var e=this;this.setState({initialCSS:"initial whiteBG"}),this.introWindow.current.animateAway(),setTimeout((function(){return e.setState({canvasOpen:!0})}),1e3)}},{key:"createNewProof",value:function(){this.setState({popupOpen:!0})}},{key:"render",value:function(){return this.state.canvasOpen?r.a.createElement("div",{className:"App"},r.a.createElement(_,{menuItems:this.menuItems,saveProof:this.saveProof(this.state.filename),proof:this.state.proof})):r.a.createElement("div",{className:this.state.initialCSS},r.a.createElement(q,{ref:this.introWindow,recentDocs:this.state.recentDocs,setupFunc:this.setupProof}))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,n){var a=n(15).nanoid;e.exports=function(e){return{state:e,iteration:function(e,t){var n=this.state,a=n.steps,r=n.currentStep,i=n.data,s=this.copyStep(a[r]);if(!this.isInNestedGraph(s,t,e))return console.log("Insert selection is not in a subgraph of Copy selection"),null;var o=this.copyContents(this.findID(s,e));if(!o)return console.log("Copy ID could not be found in Iterate"),null;var c=this.findID(s,t);if(!c)return console.log("Insert ID could not be found in Iterate"),null;c.data=c.data.concat(o);var l=o;return"string"!==typeof o&&(l=o.id),this.changeCutLevel(s,l,i[c.id].level+1),r+=1,a.push(s),{steps:a,currentStep:r,data:i}},erasure:function(e){var t=this.state,n=t.steps,a=t.currentStep,r=t.data,i=this.copyStep(n[a]),s=this.findID(i,e);if(!s)return null;var o=this.findParent(i,e);if(!o)return null;var c=o.data.indexOf(s);return c>-1?(o.data.splice(c,1),a+=1,n.push(i),{steps:n,currentStep:a,data:r}):null},doubleCutAdd:function(e){var t=this.state,n=t.steps,r=t.currentStep,i=t.data,s=this.copyStep(n[r]),o=this.findID(s,e);if(!o)return null;var c=a(),l=a(),u={data:[{data:[o],id:l,type:"cut"}],id:c,type:"cut"},h=i[e].level;i[l]={type:"cut",level:h+1},i[c]={type:"cut",level:h},this.changeCutLevel(s,e,2);var d=this.findParent(s,e);if(!d)return null;var p=d.data.indexOf(o);return p>-1&&d.data.splice(p,1),d.data=d.data.concat(u),r+=1,n.push(s),{steps:n,currentStep:r,data:i}},doubleCutRemove:function(e){var t=this.state,n=t.steps,a=t.currentStep,r=t.data,i=this.copyStep(n[a]),s=this.findID(i,e);if(s&&"cut"===s.type){var o=s.data;if(o&&1===o.length&&"cut"===o[0].type){var c=o[0].data,l=this.findParent(i,e);if(!l)return null;this.changeCutLevel(i,o[0].id,-2);var u=l.data.indexOf(s);return u>-1&&l.data.splice(u,1),l.data=l.data.concat(c),a+=1,n.push(i),{steps:n,currentStep:a,data:r}}return null}return null},isInNestedGraph:function(e,t,n){var a=this.findParent(e,n);return a?!!this.findID(a,t)||(console.log("Child is not in nested graph of Parent"),!1):(console.log("Parent Data could not be found"),!1)},copyContents:function(e){var t=this.state.data;function n(e,n){if("string"===typeof e){var i=a();return t[i]={type:"var",var:t[e].var,x:t[e].x,y:t[e].y,level:t[e].level},i}var s={};for(var o in e)if("id"===o){var c=a();s[o]=c,t[c]={type:"cut",level:n}}else s[o]="data"!==o?e[o]:r(e[o],n+1);return s}function r(e,r){var i=[];for(var s in e)if("string"===typeof e[s]){var o=a();i.push(o),t[o]={type:"var",var:t[e[s]].var,x:t[e[s]].x,y:t[e[s]].y,level:t[e[s]].level}}else i.push(n(e[s],r));return i}var i=n(e,0);return this.state.data=t,i},changeCutLevel:function(e,t,n){var a=this.state.data;if(a[t]&&"var"===a[t].type)a[t].level+=n;else{var r=!1;s(e.data),this.state.data=a}function i(e){var i;e.id&&(i=e.id)===t&&(r=!0),r&&(a[i].level+=n),e.data&&s(e.data)}function s(e){for(var t in e)"string"!==typeof e[t]?i(e[t]):r&&(a[e[t]].level+=n)}},copyStep:function(e){var t={};function n(e){var t={};for(var n in e)"string"===typeof e[n]?t[n]=e[n]:t[n]=a(e[n]);return t}function a(e){var t=[];for(var a in e)"string"===typeof e[a]?t.push(e[a]):t.push(n(e[a]));return t}return t.data=a(e.data),t.h=e.h,t.w=e.w,t},findParent:function(e,t){var n=e;function a(e){for(var n in e)if("string"===typeof e[n]){if(e[n]===t)return!0}else{if(e[n].id&&e[n].id===t)return!0;r(e[n])}return!1}function r(e){e.data&&a(e.data)&&(n=e)}return a(e.data),n},findID:function(e,t){function n(e){for(var n in e)if("string"===typeof e[n]){if(e[n]===t)return t}else{if(e[n].id===t)return e[n];var r=a(e[n]);if(r)return r}}function a(e){if("string"===typeof e)return e===t?e:void 0;for(var a in e){if(e[a]instanceof Array)return n(e[a]);if("id"===a&&e[a]===t)return e}}return a(e)}}}}},[[24,1,2]]]);
//# sourceMappingURL=main.77bd9f19.chunk.js.map