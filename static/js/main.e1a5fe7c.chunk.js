(this["webpackJsonpexistential-graphs"]=this["webpackJsonpexistential-graphs"]||[]).push([[0],{15:function(e){e.exports=JSON.parse('{"binary":{"<->":"\\\\leftrightarrow","%":"\\\\leftrightarrow","->":"\\\\rightarrow","$":"\\\\rightarrow","&":"\\\\land","|":"\\\\lor"},"unary":{"~":"\\\\lnot","!":"\\\\lnot"},"eg":{"<->":"($1($2))(($1)$2)","%":"($1($2))(($1)$2)","->":"(($1)$2)","$":"(($1)$2)","&":"$1$2","|":"(($1)($2))"}}')},27:function(e,t,n){e.exports=n(62)},32:function(e,t,n){},33:function(e,t,n){},38:function(e,t,n){},60:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(13),s=n.n(i),o=(n(32),n(3)),c=n(4),l=n(1),u=n(6),h=n(5),p=(n(33),n(14)),d=n(7),f=n.n(d),v=n(26),m=n(8),g=n(15),b=g.binary,y=g.unary;function C(e){return"(?:"+(e=e.map((function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}))).join("|")+")"}var E=C(Object.keys(y)),k="^(".concat(E,"*[A-Za-z]+|").concat(E,"*\\((.*)\\))(").concat(C(Object.keys(b)),")(").concat(E,"*[A-Za-z]+|").concat(E,"*\\((.*)\\))$"),S=new RegExp(k),O=new RegExp("^".concat(E,"*[A-Za-z]+$")),x=new RegExp("^".concat(E,"*\\((.*)\\)$"));var w=function(e){return function e(t){var n;return!!t.match(O)||(null!==(n=S.exec(t))?null!=n&&(n[2]&&n[5]?e(n[2])&&e(n[5]):n[2]?e(n[2]):!n[5]||e(n[5])):null!==(n=x.exec(t))?e(n[1]):void 0)}(e=e.replace(/\s/g,""))},j=n(15);function N(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var D=Object.keys(j.binary);D=D.map((function(e){return N(e)}));var P=new RegExp("(?:"+D.join("|")+")","g"),I=j.unary,F=function(e){if("string"===typeof e||e instanceof String){var t;for(e=e.replace(/\s/g,"");null!==(t=P.exec(e));)e=e.substr(0,t.index)+j.binary[t[0]]+" "+e.substr(t.index+t[0].length);for(var n in Object.keys(I))t=Object.keys(I)[n],e=e.replace(new RegExp(N(t),"g"),I[t]+" ");return e=e.replace(/[^()A-Za-z\\\s]/g,"")}return""};function z(e){var t=function(e){return function(t){return t===e}},n=0;for(n in e.split(""))if(!Object.keys(I).some(t(e.charAt(n))))break;return n}var R=function(e,t){console.log(e),console.log(t),null==t&&(t=!0);var n=z(e),a=e.substr(n);return a=t?A(a):"{"+a+"}","(".repeat(n)+a+")".repeat(n)},A=function e(t){if(("string"===typeof t||t instanceof String)&&w(t)){t=t.replace(/\s/g,"");var n=S.exec(t),a=x.exec(t),r=O.exec(t);if(n){var i=e(n[1]),s=e(n[4]);return j.eg[n[3]].replace(/\$1/g,i).replace(/\$2/g,s)}return a?0!==z(t)?R(t.substr(1,t.length-2),!0):e(a[1]):r?R(t,!1):null}return null},$=function(e,t){for(var n=0,a=t;a<e.length;){if("("===e[a])n++;else if(")"===e[a]&&0===--n)return a;a++}},B=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={selected:null,functions:[{str:"Iterate",func:"iteration"},{str:"Wrap in Double Cut",func:"doubleCutEnclose"},{str:"Add Double Cut",func:"doubleCutAdd"},{str:"Remove Double Cut",func:"doubleCutRemove"},{str:"Insertion",func:"insertion"},{str:"Erasure",func:"erasure"}]},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this,t=this.props,n=t.hidden,a=t.modifyCanvas,i=t.cancelSelection,s=this.state.selected;return n?r.a.createElement(r.a.Fragment,null):r.a.createElement("div",{className:"toolbox",ref:this.canvas},r.a.createElement("h3",null,"Tools"),this.state.functions.map((function(t,n){return r.a.createElement("div",{className:"tool",style:s===n?{backgroundColor:"#AFAFAA"}:{},onClick:function(){e.state.selected===n?i():(e.setState({selected:n}),a(t.func,(function(){e.setState({selected:null})})))}},t.str)})))}}]),n}(r.a.Component),M=n(9),H=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).performRedo=a.performRedo.bind(Object(l.a)(a)),a.performUndo=a.performUndo.bind(Object(l.a)(a)),a.state={},a}return Object(c.a)(n,[{key:"handleClick",value:function(e,t,n){e.preventDefault(),n||this.props.setStep(t)}},{key:"performUndo",value:function(e){var t=this.props.state,n=t.changeHistory,a=t.steps,r=t.redoHistory,i=n.pop();i&&(r.push(a),this.props.setState(n,i.steps,r))}},{key:"performRedo",value:function(e){var t=this.props.state,n=t.changeHistory,a=t.steps,r=t.redoHistory,i=r.pop();i&&(n.push({redoHistory:r,steps:a}),this.props.setState(n,i,r))}},{key:"getColor",value:function(e){return e?"rgb(136, 136, 136)":"rgb(68, 68, 68)"}},{key:"disable",value:function(e,t){return e.concat(t.length>0?"":" disabled")}},{key:"render",value:function(){var e=this,t=this.props,n=t.hide,a=t.currentStep,i=t.stepInfo,s=t.state,o=s.changeHistory,c=s.redoHistory;if(n)return r.a.createElement(r.a.Fragment,null);var l=a===i.length-1,u=0===a;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"step-menu"},r.a.createElement("div",{style:{color:this.getColor(u)}},r.a.createElement("div",{onClick:function(t){return e.handleClick(t,0,u)}},r.a.createElement(M.a,{src:"/existential-graphs/assets/step-first.svg"})),r.a.createElement("div",{onClick:function(t){return e.handleClick(t,a-1,u)}},r.a.createElement(M.a,{src:"/existential-graphs/assets/step-prev.svg"}))),r.a.createElement("div",null,r.a.createElement("div",{className:this.disable("undo-btn",o),onClick:this.performUndo},r.a.createElement("div",{className:"undo-svg"},r.a.createElement(M.a,{src:"/existential-graphs/assets/undo.svg"}))),r.a.createElement("div",{className:this.disable("redo-btn",c),onClick:this.performRedo},r.a.createElement("div",{className:"redo-svg"},r.a.createElement(M.a,{src:"/existential-graphs/assets/redo.svg"})))),r.a.createElement("div",{style:{color:this.getColor(l)}},r.a.createElement("div",{onClick:function(t){return e.handleClick(t,a+1,l)}},r.a.createElement(M.a,{src:"/existential-graphs/assets/step-next.svg"})),r.a.createElement("div",{onClick:function(t){return e.handleClick(t,i.length-1,l)}},r.a.createElement(M.a,{src:"/existential-graphs/assets/step-last.svg"})))),r.a.createElement("div",{className:"step-text"},"Step ",a+1," of ",i.length))}}]),n}(r.a.Component),L={gridSize:1,cutPadding:{horizontal:10,vertical:5},cutCornerRadius:10,initialSeparation:50},T=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).text=r.a.createRef(),a.getCoords=a.props.getCoords,a.handleClick=a.handleClick.bind(Object(l.a)(a)),a.state={x:e.x,y:e.y,cursorOver:!1,dragging:!1},a.panzoom=a.props.panzoom,window.addEventListener("mousemove",a.onMouseMove.bind(Object(l.a)(a))),window.addEventListener("mousedown",a.handleDragStart.bind(Object(l.a)(a))),window.addEventListener("mouseup",a.handleDragEnd.bind(Object(l.a)(a))),window.addEventListener("click",a.handleClick),a}return Object(c.a)(n,[{key:"handleClick",value:function(){this.state.cursorOver&&this.props.enableHighlight&&this.props.selectedCallback&&(this.props.selectedCallback(this.props.id),this.setState({cursorOver:!1}))}},{key:"componentDidMount",value:function(){this.text.current.style.cursor="pointer"}},{key:"handleDragStart",value:function(e){this.state.cursorOver&&(this.panzoom.pause(),this.setState({dragging:!0}))}},{key:"handleDragEnd",value:function(e){this.panzoom.resume();var t=this.state,n=t.x,a=t.y;this.props.setCoords(n,a),this.setState({dragging:!1})}},{key:"onMouseMove",value:function(e){if(this.state.dragging){var t=this.getCoords(e.clientX,e.clientY),n=t.x,a=t.y;n=Math.round(n/L.gridSize)*L.gridSize,a=Math.round(a/L.gridSize)*L.gridSize,this.props.setCoords(n,a),this.setState({x:n,y:a})}}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick),window.removeEventListener("mousemove",this.onMouseMove.bind(this)),window.removeEventListener("mousedown",this.handleDragStart.bind(this)),window.removeEventListener("mouseup",this.handleDragEnd.bind(this))}},{key:"render",value:function(){var e=this,t=this.state.cursorOver&&this.props.enableHighlight;return r.a.createElement("text",{className:"noselect",pointerEvents:this.props.interaction?null:"none",x:this.state.x,y:this.state.y,id:this.props.id,fill:t?"blue":"black",onMouseEnter:function(){return e.setState({cursorOver:!0})},onMouseLeave:function(){return e.setState({cursorOver:!1})},ref:this.text},this.props.children)}}]),n}(r.a.Component),W=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).cut=r.a.createRef(),a.BB=r.a.createRef(),a.getBBoxData=a.getBBoxData.bind(Object(l.a)(a)),a.handleClick=a.handleClick.bind(Object(l.a)(a)),a.update=a.update.bind(Object(l.a)(a)),a.state={highlight:!1,bounding:{_x:0,_y:0,_w:0,_h:0}},window.addEventListener("click",a.handleClick),a}return Object(c.a)(n,[{key:"handleClick",value:function(){this.state.highlight&&this.props.enableHighlight&&this.props.selectedCallback&&(this.props.selectedCallback(this.props.id),this.setState({highlight:!1}))}},{key:"getBBoxData",value:function(){if(this.cut.current){var e=this.cut.current.getBBox(),t=e.x,n=e.y,a=e.width,r=e.height;return{_x:t-L.cutPadding.horizontal,_y:n-L.cutPadding.vertical,_w:a+2*L.cutPadding.horizontal,_h:r+2*L.cutPadding.vertical}}return{}}},{key:"update",value:function(){var e=this;this.interval||(this.interval=setInterval((function(){e.setState({bounding:e.getBBoxData()})}),1),setTimeout((function(){clearInterval(e.interval),e.interval=null}),100))}},{key:"componentDidMount",value:function(){this.update()}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("click",this.handleClick),this.interval&&clearInterval(this.interval)}},{key:"render",value:function(){var e=this,t=this.state.highlight&&this.props.enableHighlight,n=this.state.bounding,a=n._x,i=n._y,s=n._w,o=n._h;return r.a.createElement(r.a.Fragment,null,r.a.createElement("rect",{x:a,y:i,width:s,height:o,fillOpacity:"0.7",strokeOpacity:"1",stroke:"black",fill:t?"#9AA899":"white",onMouseEnter:function(t){return e.setState({highlight:!0})},onMouseLeave:function(t){return e.setState({highlight:!1})},rx:L.cutCornerRadius.toString(),ry:L.cutCornerRadius.toString()}),r.a.createElement("g",{ref:this.cut},this.props.children))}}]),n}(r.a.Component),G=(n(38),n(24)),V=n.n(G),U=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this.props.menuItems;return r.a.createElement("div",{className:"dropdown-menu"},e.map((function(e){return e.title?r.a.createElement("div",{className:"menu-title",onClick:e.func},e.title):r.a.createElement("div",{className:e})})))}}]),n}(r.a.Component),_=n(16).nanoid,J=function(e){var t=e.state,n=e.getSelection,a=e.getInsertionPoint,r=e.requestInput;return{state:t,insertion:function(){var e=Object(m.a)(f.a.mark((function e(){var n,i,s,o,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:if(n=e.sent,console.log(n),n){e.next=6;break}return e.abrupt("return",null);case 6:return i=n.id,s=n.x,o=n.y,e.next=9,r();case 9:if(c=e.sent){e.next=12;break}return e.abrupt("return",null);case 12:return console.log(i,s,o),console.log(c),e.abrupt("return",t);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),iteration:function(){var e=Object(m.a)(f.a.mark((function e(){var t,r,i,s,o,c,l,u,h,p,d,v;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({cut:"all",var:"all"});case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,a();case 7:if(r=e.sent){e.next=10;break}return e.abrupt("return",null);case 10:if(i=r.id,r.x,r.y,s=i){e.next=14;break}return e.abrupt("return",null);case 14:if(o=this.state,c=o.steps,l=o.currentStep,u=o.data,h=this.copyStep(c[l]),this.isInNestedGraph(h,s,t)){e.next=19;break}return console.log("Insert selection is not in a subgraph of Copy selection"),e.abrupt("return",null);case 19:if(p=this.copyContents(this.findID(h,t)),console.log(p),p){e.next=24;break}return console.log("Copy ID could not be found in Iterate"),e.abrupt("return",null);case 24:if((d=this.findID(h,s)).data){e.next=28;break}return console.log("Insert ID could not be found in Iterate"),e.abrupt("return",null);case 28:return d.data=d.data.concat(p),v=p,"string"!==typeof p&&(v=p.id),this.changeCutLevel(h,v,u[d.id].level+1),l+=1,c.push(h),e.abrupt("return",{steps:c,currentStep:l,data:this.offsetPosition(u,h,p.id)});case 35:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),erasure:function(){var e=Object(m.a)(f.a.mark((function e(){var t,a,r,i,s,o,c,l,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({cut:"even",var:"even"});case 2:if(null!=(t=e.sent)){e.next=5;break}return e.abrupt("return",this.state);case 5:if(a=this.state,r=a.steps,i=a.currentStep,s=a.data,o=this.copyStep(r[i]),c=this.findID(o,t)){e.next=10;break}return e.abrupt("return",null);case 10:if(l=this.findParent(o,t)){e.next=13;break}return e.abrupt("return",null);case 13:if(!((u=l.data.indexOf(c))>-1)){e.next=18;break}l.data.splice(u,1),e.next=19;break;case 18:return e.abrupt("return",null);case 19:return i+=1,r.push(o),e.abrupt("return",{steps:r,currentStep:i,data:s});case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),doubleCutEnclose:function(){var e=Object(m.a)(f.a.mark((function e(){var t,a,r,i,s,o,c,l,u,h,p,d,v;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({cut:"all",var:"all"});case 2:if(t=e.sent,a=this.state,r=a.steps,i=a.currentStep,s=a.data,o=this.copyStep(r[i]),c=this.findID(o,t)){e.next=8;break}return e.abrupt("return",null);case 8:if(l=_(),u=_(),h={data:[{data:[c],id:u,type:"cut"}],id:l,type:"cut"},p=s[t].level,s[u]={type:"cut",level:p+1},s[l]={type:"cut",level:p},this.changeCutLevel(o,t,2),d=this.findParent(o,t)){e.next=19;break}return e.abrupt("return",null);case 19:return(v=d.data.indexOf(c))>-1&&d.data.splice(v,1),d.data=d.data.concat(h),i+=1,r.push(o),e.abrupt("return",{steps:r,currentStep:i,data:s});case 25:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),doubleCutAdd:function(){var e=Object(m.a)(f.a.mark((function e(){var t,n,r,i,s,o,c,l,u,h,p,d,v,m;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a();case 2:if(t=e.sent,n=t.id,r=t.x,i=t.y,r&&i){e.next=8;break}return e.abrupt("return",null);case 8:return s=this.state,o=s.steps,c=s.currentStep,l=s.data,u=this.copyStep(o[c]),h=_(),p=_(),d=_(),v={data:[{data:[d],id:p,type:"cut"}],id:h,type:"cut"},m=n?l[n].level:-1,l[p]={type:"cut",level:m+2},l[h]={type:"cut",level:m+1},l[d]={x:r,y:i,type:"emptyvar",var:"\xa0",level:m+3},n?this.findID(u,n).data.push(v):u.data.push(v),c+=1,o.push(u),e.abrupt("return",{steps:o,currentStep:c,data:l});case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),doubleCutRemove:function(){var e=Object(m.a)(f.a.mark((function e(){var t,a,r,i,s,o,c,l,u,h,p;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({cut:"all"});case 2:if(t=e.sent,a=this.state,r=a.steps,i=a.currentStep,s=a.data,o=this.copyStep(r[i]),!(c=this.findID(o,t))||"cut"!==c.type){e.next=25;break}if(!(l=c.data)||1!==l.length||"cut"!==l[0].type){e.next=22;break}if(u=l[0].data,h=this.findParent(o,t)){e.next=13;break}return e.abrupt("return",null);case 13:return this.changeCutLevel(o,l[0].id,-2),(p=h.data.indexOf(c))>-1&&h.data.splice(p,1),h.data=h.data.concat(u),i+=1,r.push(o),e.abrupt("return",{steps:r,currentStep:i,data:s});case 22:return e.abrupt("return",null);case 23:e.next=26;break;case 25:return e.abrupt("return",null);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),isInNestedGraph:function(e,t,n){var a=this.findParent(e,n);return a?t===a.id||(!!this.findID(a,t)||(console.log("Child is not in nested graph of Parent"),!1)):(console.log("Parent Data could not be found"),!1)},copyContents:function(e){var t=this.state.data;function n(e,n){if("string"===typeof e){var r=_();return t[r]={type:"var",var:t[e].var,x:t[e].x,y:t[e].y,level:t[e].level},r}var i={};for(var s in e)if("id"===s){var o=_();i[s]=o,t[o]={type:"cut",level:n}}else i[s]="data"!==s?e[s]:a(e[s],n+1);return i}function a(e,a){var r=[];for(var i in e)if("string"===typeof e[i]){var s=_();r.push(s),t[s]={type:"var",var:t[e[i]].var,x:t[e[i]].x,y:t[e[i]].y,level:t[e[i]].level}}else r.push(n(e[i],a));return r}var r=n(e,0);return this.state.data=t,r},changeCutLevel:function(e,t,n){var a=this.state.data;if(a[t]&&"var"===a[t].type)a[t].level+=n;else{var r=!1;s(e.data),this.state.data=a}function i(e){var i;e.id&&(i=e.id)===t&&(r=!0),r&&(a[i].level+=n),e.data&&s(e.data)}function s(e){for(var t in e)"string"!==typeof e[t]?i(e[t]):r&&(a[e[t]].level+=n)}},copyStep:function(e){var t={};function n(e){var t={};for(var n in e)"string"===typeof e[n]?t[n]=e[n]:t[n]=a(e[n]);return t}function a(e){var t=[];for(var a in e)"string"===typeof e[a]?t.push(e[a]):t.push(n(e[a]));return t}return t.data=a(e.data),t.h=e.h,t.w=e.w,t},findParent:function(e,t){var n=e;function a(e){for(var n in e)if("string"===typeof e[n]){if(e[n]===t)return!0}else{if(e[n].id&&e[n].id===t)return!0;r(e[n])}return!1}function r(e){e.data&&a(e.data)&&(n=e)}return a(e.data),n},findID:function(e,t){function n(e){for(var n in e)if("string"===typeof e[n]){if(e[n]===t)return t}else{if(e[n].id===t)return e[n];var r=a(e[n]);if(r)return r}}function a(e){if("string"===typeof e)return e===t?e:void 0;for(var a in e){if(e[a]instanceof Array)return n(e[a]);if("id"===a&&e[a]===t)return e}}return a(e)},offsetPosition:function(e,t,n){this.findID(t,n);return console.log(e),e}}},Z=n(25),q=(n(20),n(10)),X=n.n(q),Y=n(16).nanoid;var K=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).canvas=r.a.createRef(),a.canvasContainer=r.a.createRef(),a.renderStep=a.renderStep.bind(Object(l.a)(a)),a.changePos=a.changePos.bind(Object(l.a)(a)),a.getSVGCoords=a.getSVGCoords.bind(Object(l.a)(a)),a.highlightCut=a.highlightCut.bind(Object(l.a)(a)),a.modifyCanvas=a.modifyCanvas.bind(Object(l.a)(a)),a.getInsertionPoint=a.getInsertionPoint.bind(Object(l.a)(a)),a.requestInput=a.requestInput.bind(Object(l.a)(a)),a.cancelSelection=a.cancelSelection.bind(Object(l.a)(a)),a.createElement=a.createElement.bind(Object(l.a)(a)),a.clickedCanvas=a.clickedCanvas.bind(Object(l.a)(a)),a.getSelection=a.getSelection.bind(Object(l.a)(a));var i=a.props.proof,s=i.premises,c=i.conclusion,u=i.steps,h=i.data;return a.state={proof:{premises:s,conclusion:c},changeHistory:[],redoHistory:[],steps:u||[],data:h||{},currentStep:0!==u.length?u.length-1:0,moveListeners:[],highlights:{cut:"none",var:"none",canvas:!1},cbFunction:null,finishCB:null,interaction:!0,functions:{insertion:function(){return J(Object(l.a)(a)).insertion()},erasure:function(){return J(Object(l.a)(a)).erasure()},iteration:function(){return J(Object(l.a)(a)).iteration()},doubleCutRemove:function(){return J(Object(l.a)(a)).doubleCutRemove()},doubleCutEnclose:function(){return J(Object(l.a)(a)).doubleCutEnclose()},doubleCutAdd:function(){return J(Object(l.a)(a)).doubleCutAdd()}},formula:"",eg:"",fitchNotation:!1},a}return Object(c.a)(n,[{key:"getInsertionPoint",value:function(){var e=this,t=new Promise((function(t,n){e.setState({canvasCb:function(n,a){e.setState({canvasCb:null}),setTimeout((function(){e.state.cbFunction?(e.state.cbFunction(null),e.setState({cbFunction:null},(function(){return t({x:n,y:a})}))):t({x:n,y:a})}),50)}})}));return new Promise(function(){var n=Object(m.a)(f.a.mark((function n(a,r){var i;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([e.getSelection({cut:"all",var:"none",canvas:!0}),t]);case 2:i=n.sent,e.state.finishCB&&e.state.finishCB(),e.setState({highlights:{cut:"none",var:"none",canvas:!1},finishCB:null,canvasCb:null,interaction:!0,cbFunction:null},(function(){var e=Object(v.a)(i,2),t=e[0],n=e[1],r=n.x,s=n.y;a({id:t,x:r,y:s})}));case 5:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}},{key:"getSelection",value:function(e){var t=this;return new Promise((function(n,a){var r=t.state,i=r.steps;r.currentStep+1===i.length&&t.setState({highlights:e,interaction:!1,cbFunction:function(e){t.setState({highlights:{cut:"none",var:"none",canvas:!1},interaction:!0,cbFunction:null},(function(){return n(e)}))}})}))}},{key:"modifyCanvas",value:function(e,t){var n=this,a=this.state,r=a.steps,i=a.changeHistory;(i=i.slice()).push({steps:Array.from(r)}),this.setState({finishCB:t},(function(){n.state.functions[e]().then((function(e){n.state.finishCB&&n.state.finishCB(),e&&n.setState(Object(p.a)({changeHistory:i,redoHistory:[]},e))}))}))}},{key:"cancelSelection",value:function(){var e=this.state,t=e.cbFunction,n=e.canvasCb,a=e.finishCB;t&&t(),n&&n(),a&&a()}},{key:"changePos",value:function(e,t,n){var a=this.state.data;Object.assign(a[e],{x:t,y:n}),this.setState(a)}},{key:"highlightCut",value:function(e){if("all"===this.state.highlights.cut)return!0;var t=!1;return e%2===1&&(t=!0),!("odd"!==this.state.highlights.cut||!t)||"even"===this.state.highlights.cut&&!t}},{key:"highlightVar",value:function(e){if("all"===this.state.highlights.var)return!0;var t=!1;return e%2===1&&(t=!0),!("odd"!==this.state.highlights.var||!t)||"even"===this.state.highlights.var&&!t}},{key:"createElement",value:function(e,t,n,a,r){var i=this.state.data,s=Y();i[s]={},i[s].x=a||0,i[s].y=r||0,i[s].type=t,i[s].var=e,n.push(s),this.setState({data:i})}},{key:"removeElement",value:function(e){this.state.steps[this.state.currentStep].push(e)}},{key:"renderStep",value:function(e){var t=this,n=this.state.data,a=this.state.steps[e];if(a){var i=function(e,a,r){n[e].x=a,n[e].y=r,t.setState({data:n})},s=function e(a){var s=[];0===a.length&&t.createElement("\xa0","emptyvar",a,0,0);var o=function(o){if("cut"===a[o].type){var c=n[a[o].id].level,l=r.a.createElement(W,{level:c,enableHighlight:t.highlightCut(c),id:a[o].id,key:a[o].id,selectedCallback:t.state.cbFunction},e(a[o].data));s.push(l)}else if("var"===t.state.data[a[o]].type){var u=t.state.data[a[o]],h=n[a[o]].level;s.unshift(r.a.createElement(T,{x:u.x,y:u.y,id:a[o],enableHighlight:t.highlightVar(h),selectedCallback:t.state.cbFunction,panzoom:t.panzoom,interaction:t.state.interaction||t.highlightVar(h),getCoords:t.getSVGCoords,setCoords:function(e,t){return i(a[o],e,t)},key:a[o]},u.var))}else if("emptyvar"===t.state.data[a[o]].type&&1===a.length){var p=t.state.data[a[o]];s.unshift(r.a.createElement(T,{x:p.x,y:p.y,id:a[o],enableHighlight:!1,selectedCallback:function(){},panzoom:t.panzoom,interaction:t.state.interaction,getCoords:t.getSVGCoords,setCoords:function(e,t){return i(a[o],e,t)},key:a[o]},p.var))}};for(var c in a)o(c);return s};return s.bind(this),s(a.data)}}},{key:"componentDidMount",value:function(){this.panzoom=V()(this.canvas.current,{maxZoom:6,minZoom:.5});var e=Math.max(document.documentElement.clientWidth,window.innerWidth||0),t=Math.max(document.documentElement.clientHeight,window.innerHeight||0),n=this.state.steps;if(0===n.length){var a=function(e,t){var n={},a=0,r=0,i=0;return{stepZero:{data:function e(t,s,o){for(var c in t)if(t[c]instanceof Array&&t[c].length>0){var l=Y();t[c]={data:e(t[c],s+1),id:l,type:"cut"},n[l]={type:"cut",level:s}}else{var u=a,h=Y();n[h]={type:"var",var:t[c],x:Math.round(u/L.gridSize)*L.gridSize,y:Math.round(0/L.gridSize)*L.gridSize,level:s},t[c]=h,i=0>i?0:i,r=u>r?u:r,a+=L.initialSeparation}return t}(e,t),h:i+22,w:r},data:n}}(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("string"===typeof t||t instanceof String){for(var a=[];n<t.length;){if("("===t[n]){var r=$(t,n),i=t.substr(n+1,r-1);i&&a.push(e(t.substr(n+1,r-1))),n=r}else if("{"===t[n]){var s=t[++n];"}"===s?a.push("\xa0"):a.push(s),n++}n++}return a}return null}(this.state.proof.premises.join("")),0),r=a.stepZero,i=a.data;n.push(r),this.setState({steps:n,data:i})}this.setState({});var s=this.state.steps[this.state.currentStep];this.panzoom.moveTo(e/2-s.w,t/2-s.h),this.panzoom.zoomTo(e/2-s.w,t/2-s.h,2)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this)}},{key:"getSVGCoords",value:function(e,t){var n=this.canvasContainer.current.createSVGPoint();return n.x=e,n.y=t,n.matrixTransform(this.canvas.current.getScreenCTM().inverse())}},{key:"clickedCanvas",value:function(e){if(this.state.canvasCb){var t=this.getSVGCoords(e.pageX,e.pageY),n=t.x,a=t.y;this.state.canvasCb(n,a)}}},{key:"requestInput",value:function(){var e=this;return new Promise((function(t,n){e.setState({showOverlay:!0,cbFunction:function(n){t(null==n?null:n),e.setState({showOverlay:!1})}})}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.proof,a=t.data,i=t.steps,s=t.currentStep,o=t.highlight,c=t.showOverlay;this.props.saveProof(Object(p.a)({},n,{data:a,steps:i}));var l=function(){};this.panzoom&&(l=this.panzoom.zoomWithWheel);var u=F(this.state.formula),h=A(this.state.formula);return r.a.createElement(Z.CSSTransitionGroup,{transitionName:"fadein",transitionAppear:!0,transitionAppearTimeout:500,transitionEnter:!1,transitionLeaveTimeout:300},r.a.createElement("div",{className:"insertOverlay".concat(c?" shown":"")},r.a.createElement("h1",null,"Formula to Insert"),r.a.createElement("input",{name:"notation",type:"checkbox",className:"check",onChange:function(t){e.setState({fitchNotation:!e.state.fitchNotation})}}),r.a.createElement("label",{for:"notation"},"\xa0Use Fitch-style notation"),r.a.createElement("br",null),this.state.fitchNotation?r.a.createElement("div",null,r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",{style:{width:"40%"}},r.a.createElement("input",{onChange:function(t){return e.setState({formula:t.target.value,eg:h})}})),r.a.createElement("td",null,u&&r.a.createElement(X.a,{math:u}))),r.a.createElement("tr",null))),"To insert: ",h&&r.a.createElement(X.a,{math:h})):r.a.createElement("div",null,r.a.createElement("input",{onChange:function(t){return e.setState({formula:t.target.value,eg:t.target.value})}}),r.a.createElement("br",null),"To insert: ",r.a.createElement(X.a,{math:this.state.formula})),r.a.createElement("span",{className:"buttons"},r.a.createElement("button",{onClick:function(){return e.state.cbFunction(e.state.eg)}},"Insert"),r.a.createElement("button",{onClick:function(){return e.state.cbFunction(null)}},"Cancel"))),r.a.createElement("div",{key:"main-div",className:"mainCanvas noselect".concat(c?" disabled":"")},r.a.createElement(U,{menuItems:this.props.menuItems}),r.a.createElement(B,{hidden:s+1!==i.length,functions:this.state.functions,modifyCanvas:this.modifyCanvas,cancelSelection:this.cancelSelection}),r.a.createElement("svg",{ref:this.canvasContainer,className:"canvas noselect",onWheel:l,onClick:this.clickedCanvas,onMouseEnter:function(){return e.setState({highlight:!0})},onMouseLeave:function(){return e.setState({highlight:!1})},style:this.state.canvasCb?{cursor:"crosshair",backgroundColor:o?"#BAC8B9":"white"}:{}},r.a.createElement("g",{ref:this.canvas},this.panzoom&&this.renderStep(this.state.currentStep))),r.a.createElement(H,{currentStep:this.state.currentStep,stepInfo:this.state.steps,setStep:function(t){return e.setState({currentStep:t,interaction:t===e.state.steps.length-1})},state:this.state,setState:function(t,n,a){e.setState({changeHistory:t,steps:n,redoHistory:a,currentStep:n.length-1})}})))}}]),n}(r.a.Component),Q=(n(60),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={premises:[""],conclusion:""},a.handleChange.bind(Object(l.a)(a)),a.removePremise.bind(Object(l.a)(a)),a.verify=a.verify.bind(Object(l.a)(a)),a.create=a.create.bind(Object(l.a)(a)),a.filename=r.a.createRef(),a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"handleChange",value:function(e,t){if(null!=t){var n=this.state.premises;n[t]=e.target.value,this.setState({premises:n})}else this.setState({conclusion:e.target.value})}},{key:"removePremise",value:function(e){var t=this.state.premises;t.splice(e,1),this.setState({premises:t})}},{key:"verify",value:function(){var e=this.state,t=e.premises,n=e.conclusion;for(var a in t)if(""===t[a]||!t[a])return!1;return!(""===n||!n)}},{key:"create",value:function(){if(console.log("Creating..."),console.log("Verification concluded "+this.verify()),this.verify()){var e=this.state,t=e.premises,n=e.conclusion;for(var a in t)t[a]=A(t[a]),console.log(t[a]);n=A(n),this.props.setupFunc(this.filename.current.value,{premises:t,conclusion:n,steps:[]})}}},{key:"getFormulaCell",value:function(e,t){var n,a,i=this;w(e)&&(n=F(e),a=A(e));var s=r.a.createElement("td",{className:"close interactive",onClick:function(){return i.removePremise(t)}},"\u2715"),o=r.a.createElement("input",{onChange:function(e){return i.handleChange(e,t)}});return null==t&&(o=r.a.createElement("input",{onChange:function(e){return i.handleChange(e)}}),s=r.a.createElement("td",{className:"close"})),0===t&&(s=r.a.createElement("td",{className:"close"})),r.a.createElement("tr",null,r.a.createElement("td",null,o),r.a.createElement("td",null,n&&r.a.createElement(X.a,{math:n})),r.a.createElement("td",null,a&&r.a.createElement(X.a,{math:a})),s)}},{key:"render",value:function(){var e=this,t=this.state,n=t.premises,a=t.conclusion;return r.a.createElement("div",{className:"content full-width"},r.a.createElement("h1",null,"Create New"),r.a.createElement("h2",null,"File Name"),r.a.createElement("input",{ref:this.filename}),r.a.createElement("table",{className:"formulaTable"}),r.a.createElement("h2",null,"Premises"),r.a.createElement("table",{className:"formulaTable"},r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,"Formula"),r.a.createElement("td",null,"TeX notation"),r.a.createElement("td",null,"EG notation"),r.a.createElement("td",{className:"close"})),n.map((function(t,n){return e.getFormulaCell(t,n)})),r.a.createElement("tr",null,r.a.createElement("td",{className:"interactive",onClick:function(){return e.setState({premises:n.concat([""])})}},r.a.createElement("span",{className:"plus"}),"Add New Premise"),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",{className:"close"})))),r.a.createElement("h2",null,"Conclusion"),r.a.createElement("table",{className:"formulaTable"},r.a.createElement("tbody",null,this.getFormulaCell(a))))}}]),n}(r.a.Component)),ee=(n(61),function(e){var t=e.recentDocs;return r.a.createElement("div",{className:"content"},r.a.createElement("div",{className:"column"},r.a.createElement("h1",null,"Existential Graphs"),r.a.createElement("p",null,"Using this tool, you can initialize proofs in the existential graph schema and then you can go through the process of solving them. You can save these proofs and look back at them later.")),r.a.createElement("div",{className:"divider"}),r.a.createElement("div",{className:"column"},r.a.createElement("h1",null,"Recent Proofs"),Object.keys(t).map((function(e){return r.a.createElement("div",{className:"proofField",style:{display:"flex",justifyContent:"space-between"}},r.a.createElement("span",{onClick:function(){return t[e].open()}},e),r.a.createElement("span",{style:{color:"gray"},onClick:function(){return t[e].delete()}},"Delete"))}))))}),te=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).createView=r.a.createRef(),a.callCreate=a.callCreate.bind(Object(l.a)(a)),a.animateAway=a.animateAway.bind(Object(l.a)(a)),a.openFile=a.openFile.bind(Object(l.a)(a)),a.state={createShown:!1,floatingWindowCSS:"floating-window shown"},a}return Object(c.a)(n,[{key:"componentDidMount",value:function(){}},{key:"animateAway",value:function(){this.setState({floatingWindowCSS:"floating-window"})}},{key:"callCreate",value:function(){this.createView.current.create()}},{key:"openFile",value:function(){var e=this,t=document.createElement("input");t.setAttribute("type","file"),t.setAttribute("accept",".egprf"),t.onchange=function(t){console.log("ONCHANGE"),t.stopPropagation(),t.preventDefault();var n=t.target.files[0];console.log(n);var a=new FileReader;a.addEventListener("load",(function(t){try{var a=JSON.parse(t.target.result);console.log(a),e.props.setupFunc(n.name.split(".egprf")[0],a)}catch(r){console.error(r),alert("Corrupt file or improper formatting.")}})),a.readAsText(n)},t.click()}},{key:"render",value:function(){var e=this,t=this.state,n=t.createShown,a=t.floatingWindowCSS;return r.a.createElement("div",{className:a},!n&&r.a.createElement(ee,{recentDocs:this.props.recentDocs}),n&&r.a.createElement(Q,{setupFunc:this.props.setupFunc,ref:this.createView}),!n&&r.a.createElement("div",{className:"toolbar"},r.a.createElement("button",{onClick:function(){return e.setState({createShown:!0})}},"New"),r.a.createElement("button",{onClick:this.openFile},"Open")),n&&r.a.createElement("div",{className:"toolbar"},r.a.createElement("button",{className:"back",onClick:function(){return e.setState({createShown:!1})}},r.a.createElement("span",null,r.a.createElement(M.a,{className:"svg",src:"/existential-graphs/assets/back-caret.svg"})),"Back"),r.a.createElement("button",{onClick:this.callCreate},"Create")))}}]),n}(r.a.Component),ne=window.localStorage,ae=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).createNewProof=a.createNewProof.bind(Object(l.a)(a)),a.setupProof=a.setupProof.bind(Object(l.a)(a)),a.openCanvas=a.openCanvas.bind(Object(l.a)(a)),a.saveProof=a.saveProof.bind(Object(l.a)(a)),a.getRecents=a.getRecents.bind(Object(l.a)(a)),a.introWindow=r.a.createRef(),a.state={initialCSS:"initial",canvasOpen:!1,popupOpen:!1,filename:"",proof:{premises:[],conclusion:"",steps:[]},recentDocs:a.getRecents()},console.log(a.state.recentDocs),a.menuItems=[{title:"Exit",func:function(){a.setState({initialCSS:"initial",canvasOpen:!1,popupOpen:!1,filename:"",proof:{premises:[],conclusion:"",steps:[]},recentDocs:a.getRecents()})}},"separator",{title:"Export",func:function(){var e=document.createElement("a"),t=new Blob([JSON.stringify(a.state.proof)],{type:"text/plain"});e.href=URL.createObjectURL(t),e.download=a.state.filename+".egprf",document.body.appendChild(e),e.click()}}],a}return Object(c.a)(n,[{key:"getRecents",value:function(){var e=this,t=ne.getItem("recentDocs");t=t?JSON.parse(t):{};var n=Object.keys(t),a=function(a){t[n[a]].open=function(){e.setState({filename:n[a],proof:t[n[a]]}),e.openCanvas()},t[n[a]].delete=function(){var t=ne.getItem("recentDocs");delete(t=t?JSON.parse(t):{})[n[a]],ne.setItem("recentDocs",JSON.stringify(t)),e.setState({recentDocs:t})}};for(var r in n)a(r);return t}},{key:"saveProof",value:function(e){var t=this.state.recentDocs;return t[e]=this.state.proof,function(n){t[e]=n,ne.setItem("recentDocs",JSON.stringify(t))}}},{key:"setupProof",value:function(e,t){this.setState({filename:e,proof:t}),this.openCanvas()}},{key:"openCanvas",value:function(){var e=this;this.setState({initialCSS:"initial whiteBG"}),this.introWindow.current.animateAway(),setTimeout((function(){return e.setState({canvasOpen:!0})}),1e3)}},{key:"createNewProof",value:function(){this.setState({popupOpen:!0})}},{key:"render",value:function(){return this.state.canvasOpen?r.a.createElement("div",{className:"App"},r.a.createElement(K,{menuItems:this.menuItems,saveProof:this.saveProof(this.state.filename),proof:this.state.proof})):r.a.createElement("div",{className:this.state.initialCSS},r.a.createElement(te,{ref:this.introWindow,recentDocs:this.state.recentDocs,setupFunc:this.setupProof}))}}]),n}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(ae,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.e1a5fe7c.chunk.js.map